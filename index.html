<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"
    />
    <meta
      name="description"
      content="Slide deck for the presentation &quot;Plotting the first point with the Vega ecosystem.&quot; at the require('lx') meetup."
    />
    <meta name="author" content="Jo√£o Palmeiro" />

    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta name="apple-mobile-web-app-status-bar-style" content="default" />

    <style>
      .container {
        display: flex;
      }
      .col {
        flex: 1;
      }
    </style>

    <title>Plotting the first point with the Vega ecosystem.</title>

    <link rel="stylesheet" href="css/reset.css" />
    <link rel="stylesheet" href="css/reveal.css" />
    <link rel="stylesheet" href="css/theme/custom.css" />

    <!-- Theme used for syntax highlighting of code -->
    <link rel="stylesheet" href="lib/css/ascetic-mod.css" />

    <!-- Printing and PDF exports -->
    <script>
      var link = document.createElement("link");
      link.rel = "stylesheet";
      link.type = "text/css";
      link.href = window.location.search.match(/print-pdf/gi)
        ? "css/print/pdf.css"
        : "css/print/paper.css";
      document.getElementsByTagName("head")[0].appendChild(link);
    </script>

    <script type="text/javascript">
      function resizeIframe(iframe) {
        iframe.height = iframe.contentWindow.document.body.scrollHeight + "px";
      }
    </script>

    <!--[if lt IE 9]>
      <script src="lib/js/html5shiv.js"></script>
    <![endif]-->
  </head>
  <body>
    <div class="reveal">
      <div class="slides">
        <section data-background="#fefefa">
          <p><small>require('lx')</small></p>
          <h2>
            Plotting the first point w/ the Vega ecosystem<span
              style="color: #f2af29;"
              >.</span
            >
          </h2>
          <p>
            <small
              >Jo√£o Palmeiro |
              <a href="https://twitter.com/joaompalmeiro">@joaompalmeiro</a> |
              Research Intern @Feedzai</small
            >
          </p>
          <!-- Source: https://github.com/gcalmettes/reveal.js-d3 -->
          <!-- onload="resizeIframe(this)" -->
          <iframe
            data-src="./lib/charts/pie-chart.html"
            style="
              margin: 0px;
              width: 100vw;
              height: 100vh;
              max-width: 100%;
              max-height: 100%;
              z-index: 1;
              border: 0;
            "
            scrolling="no"
          ></iframe>
        </section>
        <section style="text-align: left;">
          <h2>Agenda</h2>
          <ol>
            <li>Framing</li>
            <li>Vega</li>
            <li>Examples</li>
            <li>Feedzai Charting Library KO</li>
            <li>Next steps?</li>
          </ol>
        </section>
        <section data-markdown style="text-align: left;">
          <script type="text/template">
            ## Framing

            Introduce a technology based on my personal experience.

            Data <!-- .element: class="fragment" --> Visualization from a _pragmatic_ perspective for Web Development.

            At <!-- .element: class="fragment" --> the end of this talk, you will be able to describe the Vega ecosystem and identify it as an interesting alternative for your work and personal projects.
          </script>
        </section>
        <section
          data-background-iframe="https://vega.github.io/vega/"
          data-background-interactive
        ></section>
        <section data-markdown style="text-align: left;">
          <!-- Workaround for the fragments: https://github.com/hakimel/reveal.js/issues/1848 -->
          <script type="text/template">
            ## Vega

            - **Declarative** language for creating charts
            - The <!-- .element: class="fragment" --> same _language_ for static parts and for interactive parts
            - A <!-- .element: class="fragment" --> Vega chart is **specified** in a JSON format üìù
            - The <!-- .element: class="fragment" --> **specification** (our focus today) is separate from the **execution**
            - Based <!-- .element: class="fragment" --> on Leland Wilkinson's _The Grammar of Graphics_ (building blocks for Data Visualization)
          </script>
        </section>
        <section data-markdown style="text-align: left;">
          <script type="text/template">
            ## The Grammar of Graphics

            - Data üíæ
            - <!-- .element: class="fragment" --> Transform ‚öôÔ∏è
            - <!-- .element: class="fragment" --> Mark üìå (representative elements of the data)
            - <!-- .element: class="fragment" --> Encoding üó∫Ô∏è (mapping between columns and mark properties)
            - <!-- .element: class="fragment" --> Scale üìè (functions that map data values to visual values)
            - <!-- .element: class="fragment" --> Guide ü¶Æ (scale visualization)
          </script>
        </section>
        <section data-markdown style="text-align: left;">
          <script type="text/template">
            ## The Grammar of Graphics

            There are different nomenclatures (and implementations), but what is important is this foundation for the creation of any chart. üìä
          </script>
        </section>
        <section data-markdown style="text-align: left;">
          <script type="text/template">
            ## Vega

            - Low-level (but not as much as [D3](https://d3js.org/))
            - Strongly <!-- .element: class="fragment" --> backed up by research
          </script>
        </section>
        <section
          data-background-iframe="https://vega.github.io/vega/about/research/"
          data-background-interactive
        ></section>
        <section data-markdown style="text-align: left;">
          <script type="text/template">
            ## Vega

            - Low-level (but not as much as [D3](https://d3js.org/))
            - Strongly backed up by research
            - Constant development
            - <!-- .element: class="fragment" --> Noteworthy community
            - Here <!-- .element: class="fragment" --> comes the _punch line_: one of the motivations is to serve as a foundation for higher-level tools! üöß
            - <!-- .element: class="fragment" --> And here comes the "ecosystem"
          </script>
        </section>
        <section data-markdown style="text-align: left;">
          <script type="text/template">
            ## Vega ecosystem

            - Vega
            - A <!-- .element: class="fragment" --> high-level language whose graphics are compiled to Vega specifications: **Vega-Lite** (our focus from now on)
          </script>
        </section>
        <section
          data-background-iframe="https://altair-viz.github.io/"
          data-background-interactive
        ></section>
        <section
          data-background-iframe="https://package.elm-lang.org/packages/gicentre/elm-vega/latest"
          data-background-interactive
        ></section>
        <section
          data-background-iframe="https://www.queryverse.org/VegaLite.jl/stable/"
          data-background-interactive
        ></section>
        <section
          data-background-iframe="https://flourish.studio/2018/05/29/vega-lite-in-flourish/"
          data-background-interactive
        ></section>
        <section
          data-background-iframe="https://liminoid.io/"
          data-background-interactive
        ></section>
        <section data-markdown style="text-align: left;">
          <script type="text/template">
            ## Vega-Lite

            - Declarative language as well
            - <!-- .element: class="fragment" --> Grammar of interaction (an easy and quick way to specify interaction üßÇ)
              - Achieved  <!-- .element: class="fragment" --> from a _new_ building block: **selections**
            - View <!-- .element: class="fragment" --> **composition** algebra (an easy and quick way to specify layered and multi-view charts üßÇ)
            - Vega-Lite <!-- .element: class="fragment" -->  is also powerful and things are simpler than in Vega ‚Äî but there is still a **learning curve**.
          </script>
        </section>
        <section>
          <h2>Let's see code!</h2>
          <iframe
            data-src="./lib/charts/bar-chart.html"
            style="
              margin: 0px;
              width: 100vw;
              height: 100vh;
              max-width: 100%;
              max-height: 100%;
              z-index: 1;
              border: 0;
            "
            scrolling="no"
          ></iframe>
        </section>
        <section>
          <h2>Bar chart</h2>
          <div class="container">
            <div class="col">
              <pre><code class="hljs" data-trim data-line-numbers="2-5">
                {
                  "data": {
                    "url": ".../operations.csv",
                    "name": "operations"
                  }
                }
              </code></pre>
            </div>

            <div class="col">
              <iframe
                data-src="./lib/charts/bar-chart-1.html"
                style="
                  margin: 0px;
                  width: 100vw;
                  height: 100vh;
                  max-width: 100%;
                  max-height: 100%;
                  z-index: 1;
                  border: 0;
                "
                scrolling="no"
              ></iframe>
            </div>
          </div>
        </section>
        <section>
          <h2>Bar chart</h2>
          <div class="container">
            <div class="col">
              <pre><code class="hljs" data-trim data-line-numbers="6-9">
                {
                  "data": {
                    "url": ".../operations.csv",
                    "name": "operations"
                  },
                  "mark": {
                    "type": "bar", 
                    "color": "#f2af29"
                  }
                }
              </code></pre>
            </div>

            <div class="col">
              <iframe
                data-src="./lib/charts/bar-chart-2.html"
                style="
                  margin: 0px;
                  width: 100vw;
                  height: 100vh;
                  max-width: 100%;
                  max-height: 100%;
                  z-index: 1;
                  border: 0;
                "
                scrolling="no"
              ></iframe>
            </div>
          </div>
        </section>
        <section>
          <h2>Bar chart</h2>
          <div class="container">
            <div class="col">
              <pre><code class="hljs" data-trim data-line-numbers="6-15">
                  ...
                  "mark": {
                    "type": "bar", 
                    "color": "#f2af29"
                  },
                  "encoding": {
                    "x": {
                      "field": "emoji",
                      "type": "ordinal",
                      "axis": {
                        "title": "Sector", 
                        "labelAngle": 0
                      }
                    }
                  }
                }
              </code></pre>
            </div>

            <div class="col">
              <iframe
                data-src="./lib/charts/bar-chart-3.html"
                style="
                  margin: 0px;
                  width: 100vw;
                  height: 100vh;
                  max-width: 100%;
                  max-height: 100%;
                  z-index: 1;
                  border: 0;
                "
                scrolling="no"
              ></iframe>
            </div>
          </div>
        </section>
        <section>
          <h2>Bar chart</h2>
          <div class="container">
            <div class="col">
              <pre><code class="hljs" data-trim data-line-numbers="2,11-19">
                  ...
                  "encoding": {
                    "x": {
                      "field": "emoji",
                      "type": "ordinal",
                      "axis": {
                        "title": "Sector", 
                        "labelAngle": 0
                      },
                    },
                    "y": {
                      "field": "amount",
                      "type": "quantitative",
                      "axis": {
                        "title": "Amount (EUR)", 
                        "format": ".2s"
                      }
                    }
                  }
                }
              </code></pre>
            </div>

            <div class="col">
              <iframe
                data-src="./lib/charts/bar-chart-4.html"
                style="
                  margin: 0px;
                  width: 100vw;
                  height: 100vh;
                  max-width: 100%;
                  max-height: 100%;
                  z-index: 1;
                  border: 0;
                "
                scrolling="no"
              ></iframe>
            </div>
          </div>
        </section>
        <section>
          <h2>Bar chart</h2>
          <div class="container">
            <div class="col">
              <pre><code class="hljs" data-trim data-line-numbers="10-14">
                  ...
                  "encoding": {
                    "x": {
                      "field": "emoji",
                      "type": "ordinal",
                      "axis": {
                        "title": "Sector", 
                        "labelAngle": 0
                      },
                      "sort": {
                        "op": "count", 
                        "field": "amount", 
                        "order": "ascending"
                      }
                    },
                    ...
              </code></pre>
            </div>

            <div class="col">
              <iframe
                data-src="./lib/charts/bar-chart-5.html"
                style="
                  margin: 0px;
                  width: 100vw;
                  height: 100vh;
                  max-width: 100%;
                  max-height: 100%;
                  z-index: 1;
                  border: 0;
                "
                scrolling="no"
              ></iframe>
            </div>
          </div>
        </section>
        <section>
          <h2>Bar chart</h2>
          <div class="container">
            <div class="col">
              <pre><code class="hljs" data-trim data-line-numbers="2-19">
                  ...
                  "layer": [
                    {
                      "mark": {
                        "type": "bar", 
                        "color": "#f2af29"
                      },
                    },
                    {
                      "mark": {
                        "type": "text", 
                        "yOffset": -5
                      },
                      "encoding": {
                        "text": {
                          "field": "amount", 
                          "type": "quantitative", 
                          "format": ".2s"
                        }
                      ...
              </code></pre>
            </div>

            <div class="col">
              <iframe
                data-src="./lib/charts/bar-chart-6.html"
                style="
                  margin: 0px;
                  width: 100vw;
                  height: 100vh;
                  max-width: 100%;
                  max-height: 100%;
                  z-index: 1;
                  border: 0;
                "
                scrolling="no"
              ></iframe>
            </div>
          </div>
        </section>
        <section>
          <h2>Bar chart</h2>
          <div class="container">
            <div class="col">
              <pre><code class="hljs" data-trim data-line-numbers="8-13">
                  ...
                  "layer": [
                    {
                      "mark": {
                        "type": "bar", 
                        "color": "#f2af29"
                      },
                      "encoding": {
                        "tooltip": {
                          "field": "sector", 
                          "type": "ordinal"
                        }
                      }
                    ...
              </code></pre>
            </div>

            <div class="col">
              <iframe
                data-src="./lib/charts/bar-chart-7.html"
                style="
                  margin: 0px;
                  width: 100vw;
                  height: 100vh;
                  max-width: 100%;
                  max-height: 100%;
                  z-index: 1;
                  border: 0;
                "
                scrolling="no"
              ></iframe>
            </div>
          </div>
        </section>
        <section>
          <h2>Bar chart</h2>
          <div class="container">
            <div class="col">
              <pre><code class="hljs" data-trim data-line-numbers="4-8,11-17">
                  ...
                  "layer": [
                    {
                      "selection": {
                        "select": {
                          "type": "multi"
                        }
                      },
                      ...
                      "encoding": {
                        "fillOpacity": {
                          "condition": {
                            "selection": "select", 
                            "value": 1
                          },
                          "value": 0.3
                        },
                        ...
              </code></pre>
            </div>

            <div class="col">
              <iframe
                data-src="./lib/charts/bar-chart.html"
                style="
                  margin: 0px;
                  width: 100vw;
                  height: 100vh;
                  max-width: 100%;
                  max-height: 100%;
                  z-index: 1;
                  border: 0;
                "
                scrolling="no"
              ></iframe>
            </div>
          </div>
        </section>
        <section>
          <h2>Bar chart ‚úîÔ∏è</h2>
          <iframe
            data-src="./lib/charts/bar-chart.html"
            style="
              margin: 0px;
              width: 100vw;
              height: 100vh;
              max-width: 100%;
              max-height: 100%;
              z-index: 1;
              border: 0;
            "
            scrolling="no"
          ></iframe>
        </section>
        <section>
          <h2>Example 1</h2>
          <iframe
            data-src="./lib/charts/bar-chart.html"
            style="
              margin: 0px;
              width: 100vw;
              height: 100vh;
              max-width: 100%;
              max-height: 100%;
              z-index: 1;
              border: 0;
            "
            scrolling="no"
          ></iframe>
        </section>
        <section>
          <h2>Example 2</h2>
          <iframe
            data-src="./lib/charts/bar-chart.html"
            style="
              margin: 0px;
              width: 100vw;
              height: 100vh;
              max-width: 100%;
              max-height: 100%;
              z-index: 1;
              border: 0;
            "
            scrolling="no"
          ></iframe>
        </section>
        <section data-markdown style="text-align: left;">
          <script type="text/template">
            ## Feedzai Charting Library KO

            - Engineering intern during Feedzai's 2019 summer internships
            - **Motivation**:
              - <!-- .element: class="fragment" --> No standards for formatting and designing visualizations
              - <!-- .element: class="fragment" --> Reproducibility
              - <!-- .element: class="fragment" --> Different libraries are used in Feedzai's products
          </script>
        </section>
        <section data-markdown style="text-align: left;">
          <script type="text/template">
            ## Feedzai Charting Library KO

            - **Approach**:
              - <!-- .element: class="fragment" --> Expand the React UI Component library used across Feedzai products
              - Combine <!-- .element: class="fragment" --> React and Vega (there are practically no examples and [react-vega](https://github.com/vega/react-vega) offers no advantages)
              - Instead <!-- .element: class="fragment" --> of several charts, create an _end-to-end_ Histogram component and test its integration
          </script>
        </section>
        <section data-markdown style="text-align: left;">
          <script type="text/template">
            ## Feedzai Charting Library KO

            - **Histogram**:
              - <!-- .element: class="fragment" --> Basic histogram for a single distribution
              - <!-- .element: class="fragment" --> Layered histogram for two distributions
              - <!-- .element: class="fragment" --> Legend with customizable labels
              - <!-- .element: class="fragment" --> Vertical axis with a linear or logarithmic scale (semi-log plot)
              - <!-- .element: class="fragment" --> Tooltip to show some details associated with each of the bars
          </script>
        </section>
        <section data-markdown style="text-align: left;">
          <script type="text/template">
            ## Feedzai Charting Library KO

            - **Histogram**:
              - <!-- .element: class="fragment" --> In the case of the layered histogram, an interactive legend that allows viewing only one of two available distributions
              - <!-- .element: class="fragment" --> A dynamic number of labels depending on the number of bins
              - <!-- .element: class="fragment" --> Button with action links to save the chart in two different image formats
              - <!-- .element: class="fragment" --> A threshold marker to specify a reference value
          </script>
        </section>
        <section data-markdown style="text-align: left;">
          <script type="text/template">
            ## Feedzai Charting Library KO

            - **Tech stack** (plus React and Vega):
              - [Vega-Embed](https://github.com/vega/vega-embed)
              - [Jest](https://jestjs.io/)
              - [Enzyme](https://enzymejs.github.io/enzyme/)
              - [Lodash](https://lodash.com/)
              - [Storybook](https://storybook.js.org/)
          </script>
        </section>
        <section data-markdown style="text-align: left;">
          <script type="text/template">
            ## Feedzai Charting Library KO

            - Typical folder structure, but with a new folder for JSON specifications
            - <!-- .element: class="fragment" --> One of the responsibilities of the Histogram component is to adapt and customize the Vega specification
            - <!-- .element: class="fragment" --> Refs to facilitate the identification of the container in which the histogram is embedded
          </script>
        </section>
        <section>
          <h2>Lifecycle Methods Wrapping</h2>
          <pre><code class="hljs" data-trim data-line-numbers>
            class Histogram extends React.Component {
              constructor(props) {
                  super(props);
                  this.histogramRef = React.createRef();
              }

              componentDidMount() {
                  this._createView();
              }
              componentDidUpdate() {
                  this._updateView();
              }
              componentWillUnmount() {
                  this._clearView();
              }
          
              render() {
                  return &lt;div ref={this.histogramRef} /&gt;;
              }
            }
					</code></pre>
        </section>
        <section data-markdown style="text-align: left;">
          <script type="text/template">
            ## Feedzai Charting Library KO

            - The Histogram component receives processed data ready to be visualized
            - Vega <!-- .element: class="fragment" --> has a well-defined data model which uses _tabular_ data ‚ö†Ô∏è
          </script>
        </section>
        <section data-markdown style="text-align: left;">
          <script type="text/template">
            ## Feedzai Charting Library KO

            - There are 3 things on the Vega and Vega-Lite roadmap that we would like to see completed:
              - <!-- .element: class="fragment" --> Animations
              - <!-- .element: class="fragment" --> Improved React support
              - (<!-- .element: class="fragment" -->_Smart_) labeling ([Vega-Label](https://github.com/vega/vega-label))
          </script>
        </section>
        <section data-markdown style="text-align: left;">
          <script type="text/template">
            ## Next steps?

            - [Medium blogpost](https://medium.com/feedzaitech/plotting-the-first-point-of-the-feedzai-charting-library-50f21b4a5e01) about the Feedzai Charting Library
            - Vega-Lite <!-- .element: class="fragment" --> [paper](http://idl.cs.washington.edu/papers/vega-lite/)
            - Vega-Lite <!-- .element: class="fragment" --> [example gallery](https://vega.github.io/vega-lite/examples/)
            - Basic <!-- .element: class="fragment" --> [HTML file](https://vega.github.io/vega-lite/tutorials/getting_started.html#embed) for Vega-Lite
            - React <!-- .element: class="fragment" --> + Vega [demo](https://github.com/joaopalmeiro/react-vega-demo)
            - Streaming <!-- .element: class="fragment" --> data [tutorial](https://vega.github.io/vega-lite/tutorials/streaming.html)
            - UW's <!-- .element: class="fragment" --> [Data Visualization course](https://courses.cs.washington.edu/courses/cse512/19sp/)
          </script>
        </section>
        <section data-markdown data-background="#fefefa">
          <script type="text/template">
            # Thanks! üòÑ

            [Slide deck](https://github.com/joaopalmeiro/vega-presentation-require-lx)

            - Vega and Vega-Lite are two powerful alternatives for Data Visualization üìä
            - Charts are declared using a JSON specification üìù
            - It is possible to combine them with React ‚öõÔ∏è
          </script>
        </section>
      </div>
    </div>

    <script src="js/reveal.js"></script>

    <script>
      // More info about config & dependencies:
      // - https://github.com/hakimel/reveal.js#configuration
      // - https://github.com/hakimel/reveal.js#dependencies
      Reveal.initialize({
        hash: true,
        controls: false,
        preloadIframes: true,
        slideNumber: function (slide) {
          return !Reveal.isFirstSlide() && !Reveal.isLastSlide()
            ? [Reveal.getIndices(slide).h]
            : [""];
        },
        dependencies: [
          { src: "plugin/markdown/marked.js" },
          { src: "plugin/markdown/markdown.js" },
          { src: "plugin/highlight/highlight.js" },
        ],
      });
    </script>
  </body>
</html>
